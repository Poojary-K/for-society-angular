<div class="feed-page">
  <!-- Feed Content -->
  <div class="feed-content">
    <!-- Recent Contributions -->
    <div class="section-header">
      <h3 class="section-title">Recent Contributions</h3>
    </div>
    @if (loading) {
      <div class="loading-state">Loading contributions...</div>
    } @else if (contributions.length === 0) {
      <app-card variant="outlined" class="empty-card">
        <p class="empty-message">No contributions yet.</p>
      </app-card>
    } @else {
      <div class="contributions-list">
        @for (contribution of getDisplayedContributions(); track contribution.contributionid) {
          <app-card variant="elevated" class="contribution-card" [clickable]="true">
            <div class="contribution-content" (click)="viewContribution(contribution)">
              <div class="contribution-header">
                <div class="contribution-info">
                  <div class="contribution-label">Contribution Amount</div>
                  <div class="contribution-amount">₹{{ contribution.amount }}</div>
                </div>
                <div class="contribution-date-info">
                  <div class="contribution-label">Date</div>
                  <div class="contribution-date">{{ formatDate(contribution.contributeddate) }}</div>
                </div>
              </div>
              <div class="contribution-member">
                <div class="member-info">
                  <i class="fas fa-user"></i>
                  <span>{{ getMemberName(contribution.memberid) }}</span>
                </div>
                @if (isAdmin) {
                  <div class="card-actions">
                    <button class="action-btn edit-btn" (click)="editContribution(contribution, $event)" title="Edit">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn" (click)="deleteContribution(contribution, $event)" title="Delete">
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                }
              </div>
            </div>
          </app-card>
        }
      </div>

      <!-- Show All / Show Less Button -->
      @if (contributions.length > 10) {
        <div class="show-all-container">
          @if (!showAllContributions()) {
            <button class="show-all-btn" (click)="showAll()">
              <span>Show All Contributions</span>
              <i class="fas fa-chevron-down"></i>
            </button>
          } @else {
            <button class="show-all-btn" (click)="showLess()">
              <span>Show Less</span>
              <i class="fas fa-chevron-up"></i>
            </button>
          }
        </div>
      }
    }
  </div>

  <!-- FAB Menu -->
  @if (isAdmin) {
    <div class="fab-container">
      @if (showFabMenu) {
        <div class="fab-menu">
          <button class="fab-menu-item" (click)="addContribution()">
            <span>Add Contribution</span>
          </button>
          <button class="fab-menu-item" (click)="createCause()">
            <span>Create Cause</span>
          </button>
        </div>
      }
      <app-button type="fab" (click)="toggleFabMenu()">
        {{ showFabMenu ? '×' : '+' }}
      </app-button>
    </div>
  }

  <!-- Modals -->
  <app-create-cause />
  <app-add-contribution *ngIf="isAdmin" />
</div>

