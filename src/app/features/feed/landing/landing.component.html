<div class="landing-page" [class.viewer-open]="causeViewerOpen">
  <!-- Hero Section -->
  <section class="hero-section">
    <h2 class="hero-title">Together We Make a Difference</h2>
    <p class="hero-subtitle">Support causes that matter. Track contributions. Build a better society.</p>

    @if (fundStatus) {
      <app-card variant="elevated" class="fund-chart-card">
        <h3 class="card-title">Fund Status</h3>
        <app-pie-chart
          [totalContributions]="parseFloat(fundStatus.totalcontributions || '0')"
          [totalDonations]="parseFloat(fundStatus.totaldonations || '0')"
          [availableFunds]="parseFloat(fundStatus.availablefunds || '0')"
        />
        @if (currentCycleTotal !== null) {
          <div class="cycle-summary">
            <div class="cycle-label">Current cycle donation</div>
            <div class="cycle-value">₹{{ currentCycleTotal | number:'1.0-2' }}</div>
            <div class="cycle-range">{{ currentCycleLabel }}</div>
          </div>
        }
      </app-card>
    }

    <div class="scroll-indicator">
      <span>Scroll to explore</span>
      <span class="arrow">↓</span>
    </div>
  </section>

  <!-- Causes Feed -->
  <section class="causes-section">
    <h3 class="section-title">Active Causes</h3>
    @if (loading) {
      <div class="loading-state">Loading causes...</div>
    } @else if (causes.length === 0) {
      <div class="empty-state">
        <p>No causes yet. Be the first to create one!</p>
      </div>
    } @else {
      <div class="causes-list">
        @for (cause of causes; track cause.causeid) {
          <app-card variant="elevated" class="cause-card" [clickable]="true" appScrollAnimation>
            <div
              class="cause-media"
              [class.clickable]="getCauseImageUrl(cause.causeid)"
              (click)="openCauseViewer(cause.causeid)"
            >
              @if (getCauseImageUrl(cause.causeid) && !isCauseImageFailed(cause.causeid)) {
                <img
                  [src]="getCauseImageUrl(cause.causeid)!"
                  [alt]="cause.title"
                  (error)="onCauseImageError(cause.causeid, $event)"
                />
              } @else {
                <div class="cause-placeholder">
                  <i class="fas fa-image"></i>
                </div>
              }
            </div>
            <div class="cause-content">
              <h4 class="cause-title">{{ cause.title }}</h4>
              @if (cause.description) {
                <p class="cause-description">{{ cause.description }}</p>
              }
              @if (cause.amount) {
                <div class="cause-amount">Target: ₹{{ cause.amount }}</div>
              }
              <div class="cause-date">{{ formatDate(cause.createdat) }}</div>
            </div>
          </app-card>
        }
      </div>
    }
  </section>

  <!-- CTA Section -->
  @if (!isAuthenticated) {
    <section class="cta-section">
      <app-button type="primary" [fullWidth]="true" (click)="navigateToLogin()">
        Join Us Today
      </app-button>
    </section>
  }

  @if (causeViewerOpen && activeCauseImage) {
    <div class="image-viewer-backdrop" (click)="closeCauseViewer()">
      <div class="image-viewer" (click)="$event.stopPropagation()">
        <button class="viewer-close" (click)="closeCauseViewer()" aria-label="Close image viewer">
          <i class="fas fa-times"></i>
        </button>
        <div class="viewer-content">
          @if (getActiveCauseImages().length > 1) {
            <button class="viewer-nav prev" (click)="prevCauseImage()" aria-label="Previous image">
              <i class="fas fa-chevron-left"></i>
            </button>
          }
          <div class="viewer-image">
            @if (hasViewerImageError(activeCauseImage)) {
              <div class="viewer-error">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Preview unavailable. Open the image in a new tab.</p>
                <a class="viewer-link" [href]="activeCauseImage.url" target="_blank" rel="noopener">
                  Open Image
                </a>
              </div>
            } @else {
              <img
                [src]="getViewerImageUrl(activeCauseImage)"
                [alt]="activeCauseImage.imageid ? 'Cause image ' + activeCauseImage.imageid : 'Cause image'"
                (error)="onViewerImageError(activeCauseImage, $event)"
              />
            }
          </div>
          @if (getActiveCauseImages().length > 1) {
            <button class="viewer-nav next" (click)="nextCauseImage()" aria-label="Next image">
              <i class="fas fa-chevron-right"></i>
            </button>
          }
        </div>
        <div class="viewer-footer">
          {{ activeImageIndex + 1 }} / {{ getActiveCauseImages().length }}
        </div>
      </div>
    </div>
  }
</div>
